

/**
 * of_pci_check_probe_only - Setup probe only mode if linux,pci-probe-only
 *                           is present and valid
 */
void of_pci_check_probe_only(void)
{
        u32 val;
        int ret;

        ret = of_property_read_u32(of_chosen, "linux,pci-probe-only", &val);
        if (ret) {
                if (ret == -ENODATA || ret == -EOVERFLOW)
                        pr_warn("linux,pci-probe-only without valid value, ignoring\n");
                return;
        }

        if (val)
                pci_add_flags(PCI_PROBE_ONLY);
        else
                pci_clear_flags(PCI_PROBE_ONLY);

        pr_info("PROBE_ONLY %sabled\n", val ? "en" : "dis");
}
EXPORT_SYMBOL_GPL(of_pci_check_probe_only);